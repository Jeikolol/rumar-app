<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="RumarApp.Views.LoginControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:RumarApp.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:RumarApp.ViewModels" 
    d:DataContext="{d:DesignInstance Type=viewmodels:LoginViewModel}"
    mc:Ignorable="d">

    <ScrollViewer Padding="20">
        <Grid Padding="20" MaxWidth="400" HorizontalAlignment="Center">
            <StackPanel Spacing="20" Margin="0,40,0,40">

                <!-- Logo -->
                <Image Source="/Assets/logo2.png" 
                       Width="320" 
                       Height="150"
                       HorizontalAlignment="Center"/>

                <!-- Welcome Text -->
                <TextBlock Text="Inicia sesión en tu cuenta" 
                           FontSize="16" 
                           Foreground="{StaticResource Gold300Brush}"
                           HorizontalAlignment="Center"
                           TextAlignment="Center"/>

                <!-- Email Input -->
                <StackPanel Spacing="8">
                    <TextBox x:Name="EmailBox"
                             PlaceholderText="Correo electrónico" 
                             Foreground="{StaticResource Gold300Brush}" 
                             Text="{Binding Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             InputScope="EmailNameOrAddress"/>

                    <!-- Email Validation Error -->
                    <StackPanel x:Name="InvalidEmailError" 
                                Orientation="Horizontal" 
                                Spacing="4"
                                Visibility="{Binding IsEmailValid, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}">
                        <FontIcon Glyph="&#xEA39;" 
                                  Foreground="{ThemeResource SystemFillColorCriticalBrush}" 
                                  FontSize="14"/>
                        <TextBlock Text="Correo electrónico inválido" 
                                   Foreground="{ThemeResource SystemFillColorCriticalBrush}"
                                   FontSize="12"/>
                    </StackPanel>
                </StackPanel>

                <!-- Password Input -->
                <PasswordBox x:Name="PasswordBox" 
                             PlaceholderText="Contraseña"
                             Password="{Binding Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             Foreground="{StaticResource Gold300Brush}"/>

                <!-- Error Message -->
                <StackPanel Orientation="Horizontal" 
                            Spacing="4"
                            Visibility="{Binding HasError, Converter={StaticResource BoolToVisibilityConverter}}">
                    <FontIcon Glyph="&#xEA39;" 
                              Foreground="{ThemeResource SystemFillColorCriticalBrush}" 
                              FontSize="14"/>
                    <TextBlock Text="{Binding ErrorMessage}" 
                               Foreground="{ThemeResource SystemFillColorCriticalBrush}"
                               FontSize="12"
                               TextWrapping="Wrap"/>
                </StackPanel>

                <!-- Login Button -->
                <Button 
                        Command="{Binding LoginCommand}" 
                        Style="{StaticResource GoldenButtonStyle}"
                        HorizontalAlignment="Stretch">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <ProgressRing IsActive="{Binding IsBusy}" 
                                          Width="16" 
                                          Height="16"
                                          Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            <TextBlock Text="{Binding IsBusy, Converter={StaticResource BoolToStringConverter}, ConverterParameter='Iniciando sesión...|Iniciar sesión'}"/>
                        </StackPanel>
                    </Button.Content>
                </Button>

                <!-- Additional Options -->
                <StackPanel Spacing="10" Margin="0,20,0,0">
                    <HyperlinkButton Content="¿Olvidaste tu contraseña?" 
                                     HorizontalAlignment="Center"
                                     Foreground="{StaticResource Gold300Brush}"/>
                </StackPanel>

            </StackPanel>
        </Grid>
    </ScrollViewer>
</UserControl>
